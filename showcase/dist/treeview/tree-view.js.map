{"version":3,"sources":["../src/treeview/tree-view.ts"],"names":[],"mappings":"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","file":"tree-view.js","sourcesContent":["import jquery = require(\"jquery\");\r\nimport \"jstree/dist/themes/default/style.min.css!\";\r\nimport \"jstree\";\r\n//import \"jstree-grid\";\r\nimport {SystemApplication} from \"../core/system-application\";\r\nimport {EventEmitter} from \"../core/event-emitter\";\r\nimport {AWidget} from \"../widget/abstract/a-widget\";\r\nimport {IDataComponent} from \"../component/interface/i-data-component\";\r\n\r\nexport interface INodeTreeView{\r\n\tid?: string|number; // will be autogenerated if omitted\r\n\ttext: string; // node text\r\n\ticon?: string; // string for custom\r\n\tstate?: {\r\n\t\topened?: boolean  // is the node open\r\n\t\tdisabled?: boolean  // is the node disabled\r\n\t\tselected?: boolean  // is the node selected\r\n\t};\r\n\tdata?:any;\r\n\tchildren?:INodeTreeView[];  // array of strings or objects\r\n\ta_attr?:{href:string,id?:string};\r\n}\r\n\r\nexport interface INodeTreeViewExtended extends INodeTreeView{\r\n\tparent:string;\r\n}\r\n\r\ninterface ITreeViewComponent{\r\n\trefresh():void;\r\n\tdestroy():void;\r\n\tsettings:{core:{data:INodeTreeView[]}};\r\n}\r\n\r\nexport enum ETreeViewPosition{\r\n\tLAST,FIRST\r\n}\r\n\r\n/**\r\n * <img src=\"../../doc_assets/treeview_example_1.png\" />\r\n *\r\n * @example\r\n * let treeview = new TreeView();\r\n * let box = new Box();\r\n * box.append(treeview);\r\n * treeview.setNodes([\r\n * {\r\n *  id:1\r\n *  ,text:\"folder 1\"\r\n *  ,icon:\"glyphicon glyphicon-unchecked\"\r\n * }\r\n * ,{\r\n *  id:2\r\n *  ,text:\"folder 2\"\r\n *  ,icon:\"glyphicon glyphicon-unchecked\"\r\n *  ,children:[\r\n *              {id:21,text:\"folder a\" , data:{\"desc\":\"extra data\"}}\r\n *              ,{id:22,text:\"folder b\"}\r\n *              ,{id:23,text:\"folder c\"}\r\n *             ]\r\n *           }\r\n *           ,{\r\n *             id:3\r\n *             ,text:\"folder 3\"\r\n *           }\r\n * ]);\r\n *\r\n *\r\n * @export\r\n * @memberof module:mvcomponents/treeview\r\n */\r\nexport class TreeView extends AWidget{\r\n\tprivate _loaded:boolean;\r\n\tpublic onSelect:EventEmitter<INodeTreeView[]> = new EventEmitter<INodeTreeView[]>();\r\n\tconstructor(){\r\n\t\tsuper(\"div\", \"\");\r\n\t\tjquery(this.element).addClass(\"TreeView col-xs-12\");\r\n\t}\r\n\t/**\r\n\t * Força uma atualização no treeview. \r\n\t *\r\n\t * @return {TreeView}\r\n\t */\r\n\tpublic refresh():this{\r\n\t\t(<any>jquery(this.element)).jstree(true).refresh();\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t * Limpa o treeview.\r\n\t *\r\n\t * @return {TreeView}\r\n\t */\r\n\tpublic clear():this{\t\r\n\t\tthis.setNodes([]);\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t * Adiciona um nó especifico de acordo com um parente informado ou o ultimo nó selecionado.\r\n\t *\r\n\t * @param p_node {INodeTreeView}\r\n\t * @param p_posi {ETreeViewPosition}\r\n\t * @return {TreeView}\r\n\t */\r\n\tpublic addNode(p_node:INodeTreeView,p_posi:ETreeViewPosition=ETreeViewPosition.LAST,p_parent?:any):TreeView{\r\n\t\tlet tmp_parent = p_parent||(<any>jquery(this.element)).jstree(\"get_selected\");\r\n\t\t//console.log(ETreeViewPosition[p_posi].toLowerCase());\r\n\t\t(<any>jquery(this.element)).jstree(\"create_node\", tmp_parent, p_node,ETreeViewPosition[p_posi].toLowerCase());\r\n\t\treturn this;\r\n\t}\r\n\r\n\tprivate removeNode(p_node:INodeTreeView):TreeView{\r\n\t\t//let tmp_node = (<any>jquery(this.element)).jstree(true).get_node(p_node.id);\r\n\t\t(<any>jquery(this.element)).jstree(\"delete_node\", p_node);\r\n\t\treturn this;\r\n\t}\t\r\n\r\n\t/**\r\n\t * Retorna o ultimo nó selecionado.\r\n\t *\r\n\t * @return {INodeTreeView}\r\n\t */\r\n\tpublic getSelectedNode():INodeTreeView{\r\n\t\tlet {id,a_attr,icon,text,state,data} = (<any>jquery(this.element)).jstree(true).get_selected(true)[0];\r\n\t\treturn {\r\n\t\t\t\tid\r\n\t\t\t\t,a_attr:{href:a_attr.href,id:a_attr.id}\r\n\t\t\t\t,icon\r\n\t\t\t\t,text\r\n\t\t\t\t,state\r\n\t\t\t\t,data\r\n\t\t};\r\n\t}\r\n\t/**\r\n\t * Atualiza os nós do treeview.\r\n\t *\r\n\t * @param {INodeTreeView[]}\r\n\t * @return {TreeView}\r\n\t */\r\n\tpublic setNodes(p_nodes: INodeTreeView[]): this {\t\t\r\n\t\tif(!this._loaded){\r\n\t\t\tthis._loaded = true;\r\n\t\t\t(<any>jquery(this.element)).jstree({\r\n\t\t\t\t\"core\":{\r\n\t\t\t\t\t\"data\":p_nodes\r\n\t\t\t\t\t,\"check_callback\":true\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\t\t\r\n\t\t\tjquery(this.element).on(\"select_node.jstree\",(evt:Event,data:any)=>{\r\n\t\t\t\tthis.onSelect.emit([this.getSelectedNode()]);\t\t\t\r\n\t\t\t});\r\n\t\t\t//this.onNodeClick.emit(this.getSelectedNode());\r\n\t\t}else{\r\n\t\t\t(<ITreeViewComponent>(<any>jquery(this.element)).jstree(true)).settings.core.data = p_nodes;\r\n\t\t\tthis.refresh();\r\n\t\t}\t\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t * Atualiza o icone e texto de um nó especifico.\r\n\t *\r\n\t * @param {INodeTreeView}\r\n\t * @return {TreeView}\r\n\t */\t\r\n\tpublic updateNode(p_node: INodeTreeView): this {\r\n\t\tlet tmp_node = (<any>jquery(this.element)).jstree(true).get_node(p_node.id);\r\n\t\t//Object.assign(tmp_node,p_node);\r\n\t\ttmp_node.data = Object.assign({},tmp_node.data,p_node.data);\r\n\t\tlet jstreeRef = (<any>jquery(this.element));\r\n\t\t//jstreeRef.jstree(\"set_state\",tmp_node,p_node.state);\r\n\t\tjstreeRef.jstree(\"set_icon\",tmp_node,p_node.icon);\r\n\t\tjstreeRef.jstree(\"rename_node\",tmp_node,p_node.text);\r\n\t\treturn this;\r\n\t}\r\n}\r\n"]}