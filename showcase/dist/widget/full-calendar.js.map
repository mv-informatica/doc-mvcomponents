{"version":3,"sources":["../src/widget/full-calendar.ts"],"names":[],"mappings":"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","file":"full-calendar.js","sourcesContent":["import \"fullcalendar/dist/fullcalendar.min.css!\";\r\nimport \"./assets/css/fullcalendar.css!\";\r\nimport {ICustomComponent} from \"../core/interface/i-custom-component\";\r\nimport {EventEmitter} from \"../core/event-emitter\";\r\n//import moment = require(\"moment\");\r\nimport * as moment from \"moment\";\r\nimport jquery = require(\"jquery\");\r\nimport \"fullcalendar\";\r\nimport {AWidget} from \"./abstract/a-widget\";\r\nimport {EFullCalendarView} from \"./enum/e-full-calendar\";\r\nimport {IFullCalendar, IFullCalendarConfig, IFullCalendarEvent, IFullCalendarPeriod} from \"./interface/i-full-calendar\";\r\n\r\n/**\r\n * Calendário dinâmico que permite a visualização de datas e eventos.\r\n * \r\n * <img width=\"100%\" src=\"../../doc_assets/fullcalendar.png\" title=\"Full Calendar\" alt=\"Full Calendar\">\r\n * \r\n * @example\r\n *   let panel: Panel = new Panel(\"Calendário 1\");\r\n *   panel.setSize(4);\r\n *   let config: IFullCalendarConfig = {\r\n *      defaultDate: moment(),\r\n *      defaultView: EFullCalendarView.MONTH\r\n *   };\r\n *   let calendar: FullCalendar = new FullCalendar(config);\r\n *   panel.append(calendar);\r\n *   calendar.onPeriodChange.subscribe((periodo: IFullCalendarPeriod) => {\r\n *          $http\r\n *              .get(\"http://localhost:3000/test/mock/events.json\")\r\n *              .params({\"start\": periodo.start.toISOString(), \"end\": periodo.end.toISOString()})\r\n *              .then((events: IFullCalendarEvent[]) => {\r\n *                  console.log(\"Eventos recuperados...\", events);\r\n *                  calendar.events = events;\r\n *              });\r\n *   });\r\n * \r\n * @extends {AWidget}\r\n * @implements {IFullCalendar}\r\n * @implements {ICustomComponent}\r\n * @memberof module:mvcomponents/calendar\r\n */\r\nexport class FullCalendar extends AWidget implements IFullCalendar, ICustomComponent {\r\n\t/**\r\n\t * Configurações padrão do calendário\r\n\t */\r\n\tprotected config: IFullCalendarConfig;\r\n\r\n\t/**\r\n\t * Este @{link EventEmitter} é executado toda vez que a visualização do calendário é alterada.\r\n\t * \r\n\t * @type {EventEmitter<IFullCalendarPeriod>}\r\n\t */\r\n\tpublic onPeriodChange:EventEmitter<IFullCalendarPeriod> = new EventEmitter<IFullCalendarPeriod>();\r\n\r\n\t/**\r\n\t * Este @{link EventEmitter} é executado toda vez que um evento é clicado.\r\n\t * \r\n\t * @type {EventEmitter<IFullCalendarEvent>}\r\n\t */\r\n\tpublic onEventClick:EventEmitter<IFullCalendarEvent> = new EventEmitter<IFullCalendarEvent>();\r\n\r\n\t/**\r\n\t * Este @{link EventEmitter} é executado toda vez que um dia do calendário é clicado.\r\n\t * \r\n\t * @type {EventEmitter<moment.Moment>}\r\n\t */\r\n\tpublic onDayClick:EventEmitter<moment.Moment> = new EventEmitter<moment.Moment>();\r\n\r\n\t/**\r\n\t * Variável para controle dos eventos que serão exibidos\r\n\t * \r\n\t * @private\r\n\t * @type {IFullCalendarEvent[]}\r\n\t */\r\n\tprivate _events:IFullCalendarEvent[] = [];\r\n\t\r\n\t/**\r\n\t * Atribui os eventos que o calendário deve exibir. Sempre que este método é chamado, os eventos existentes no calendário\r\n\t * são excluídos e os eventos do parâmetro são adicionados.\r\n\t */\r\n\tpublic set events(evts:IFullCalendarEvent[]) {\r\n\t\tthis._events = evts;\r\n\t\tthis.removeCalendarEvents();\r\n\t\tthis.calendar(\"addEventSource\", this._events);\r\n\t}\r\n\r\n\tconstructor(config: IFullCalendarConfig) {\r\n\t\tsuper(\"div\", \"\");\r\n\t\tjquery(this.element).addClass(\"FullCalendar\");\r\n\t\tthis.config = config;\r\n\t}\r\n\r\n\tpublic init():FullCalendar{\r\n\t\t(<any>jquery(this.element)).fullCalendar(this.parseConfig(this.config));\r\n\t\tthis.calendar(\"addEventSource\", {\r\n\t\t\tevents: (start:Date, end:Date, timezone?:string|boolean, addCalendarEvents?:Function) => {\r\n\t\t\t\tthis.onPeriodChange\r\n\t\t\t\t\t\t.emit({ \"start\": start, \"end\": end })\r\n\t\t\t\t\t\t.done(() => addCalendarEvents(this._events));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t}\r\n\r\n\tpublic attached():void{        \r\n\t\tif(jquery(this.element).is(\":visible\")){\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Retorna o objeto jquery que representa o plugin fullcalendar\r\n\t */\r\n\tget calendar(): any {\r\n\t\treturn (<any>jquery(this.element)).fullCalendar.bind(jquery(this.element));\r\n\t}\r\n\r\n\t/**\r\n\t * Altera as configurações para que se adequem aos valores esperados pelo plugin fullcalendar\r\n\t */\r\n\tprivate parseConfig(config: IFullCalendarConfig) : any {\r\n\t\tlet cfg: any = jquery.extend({}, config);\r\n\t\tif (config.defaultView !== undefined) {\r\n\t\t\tcfg.defaultView = this.translateView(config.defaultView);\r\n\t\t}\r\n\t\t//adiciona a função que escuta os cliques nos eventos do calendário\r\n\t\tcfg.eventClick = (event: IFullCalendarEvent, jsEvent: any, view:any) => {\r\n\t\t\tthis.onEventClick.emit(event);\r\n\t\t};\r\n\t\t//adiciona a função que escuta os cliques nos dias do calendário\r\n\t\tcfg.dayClick = (day: moment.Moment, jsEvent: any, view: any) => {\r\n\t\t\tthis.onDayClick.emit(day);\r\n\t\t};\r\n\t\treturn cfg;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Traduz os valores do enum {@link EFullCalendarView} para um valor válido do plugin fullcalendar\r\n\t */\r\n\tprivate translateView(view: EFullCalendarView): string {\r\n\t\tswitch (view) {\r\n\t\t\tcase EFullCalendarView.AGENDA_DAY: return \"agendaDay\";\r\n\t\t\tcase EFullCalendarView.AGENDA_WEEK: return \"agendaWeek\";\r\n\t\t\tcase EFullCalendarView.DAY: return \"basicDay\";\r\n\t\t\tcase EFullCalendarView.MONTH: return \"month\";\r\n\t\t\tcase EFullCalendarView.WEEK: return \"basicWeek\";\r\n\t\t}\r\n\t\tthrow \"Invalid Full Calendar View\";        \r\n\t}\r\n\t\r\n\tprivate removeCalendarEvents(events?: IFullCalendarEvent[]): void {\r\n\t\tthis.calendar(\"removeEvents\", events);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização atual do calendário em um período à frente\r\n\t */\r\n\tpublic prev(): void {\r\n\t\tthis.calendar(\"prev\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização atual do calendário em um período atrás\r\n\t */\r\n\tpublic next(): void {\r\n\t\tthis.calendar(\"next\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização atual do calendário em um ano à frente.\r\n\t */\r\n\tpublic prevYear(): void {\r\n\t\tthis.calendar(\"prevYear\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização atual do calendário em um ano atrás.\r\n\t */\r\n\tpublic nextYear(): void {\r\n\t\tthis.calendar(\"nextYear\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização do calendário para a data atual.\r\n\t */\r\n\tpublic today(): void {\r\n\t\tthis.calendar(\"today\");\r\n\t}\r\n\t\r\n\t/**\r\n\t * Move a visualização atual do calendário para a data especificada.\r\n\t * \r\n\t * @param {moment.Moment} date\r\n\t */\r\n\tpublic gotoDate(date:Date): void {\r\n\t\t//precisa ser moment\r\n\t\t\r\n\t\tthis.calendar(\"gotoDate\", date);\r\n\t}\r\n\r\n\t/**\r\n\t * Retorna a data da visualização atual.\r\n\t * \r\n\t * @returns {moment.Moment}\r\n\t */\r\n\tpublic getDate(): Date {\r\n\t\t//precisa ver se vai ser date\r\n\t\treturn this.calendar(\"getDate\");\r\n\t}\r\n\r\n\t/**\r\n\t * Altera a forma de visualização do calendário\r\n\t * \r\n\t * @see {@link EFullCalendarView}\r\n\t * @param {EFullCalendarView} view\r\n\t */\r\n\tpublic changeView(view: EFullCalendarView): void {\r\n\t\tthis.calendar(\"changeView\", this.translateView(view));\r\n\t}\r\n}\r\n"]}