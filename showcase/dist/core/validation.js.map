{"version":3,"sources":["../src/core/validation.ts"],"names":[],"mappings":";;;IAMA,IAAM,OAAO,GAAG,cAAO,CAAC,CAAC;IAEzB,IAAI,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;IAEjC;QAAA;YAEW,aAAQ,GAA4B,OAAO,CAAC;YAC/C,aAAQ,GAAW,EAAE,CAAC;YACrB,YAAO,GAAU,KAAK,EAAE,CAAC;QAyBlC,CAAC;QAvBO,sCAAS,GAAhB,UAAiB,MAA+B;YAC/C,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QACM,sCAAS,GAAhB;YACC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACpB,CAAC;QACM,uCAAU,GAAjB,UAAkB,QAAgB;YACjC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QACM,uCAAU,GAAjB,UAAkB,MAA+B;YAChD,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;YACvB,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QACM,uCAAU,GAAjB,UAAkB,MAAS;YAC1B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,GAAG,MAAM,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC,CAAC;QACjF,CAAC;QACM,mCAAM,GAAb;YAEC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACxB,CAAC;QAEF,yBAAC;IAAD,CA7BA,AA6BC,IAAA;IA7BqB,gDAAkB;IA+BxC;QAAmC,sCAA8B;QAAjE;;QAOA,CAAC;QANO,6BAAQ,GAAf,UAAgB,KAAQ;YACvB,IAAI,OAAO,GAAY,IAAI,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;YAC7D,IAAI,OAAO,GAAW,OAAO,GAAG,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAC9D,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;YAC7B,MAAM,CAAC,OAAO,CAAC;QAChB,CAAC;QACF,iBAAC;IAAD,CAPA,AAOC,CAPkC,kBAAkB,GAOpD;IAPY,gCAAU;IASvB;QAAwC,2CAAuC;QAA/E;;QASA,CAAC;QARO,kCAAQ,GAAf,UAAgB,KAAQ;YAAxB,iBAOC;YANA,MAAM,CAAoB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,CAAE;iBACzD,IAAI,CAAC,UAAA,OAAO;gBACZ,IAAI,OAAO,GAAW,OAAO,GAAG,IAAI,GAAG,KAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBAC9D,KAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,KAAI,CAAC,CAAC;gBAC7B,MAAM,CAAC,OAAO,CAAC;YAChB,CAAC,CAAC,CAAC;QACL,CAAC;QACF,sBAAC;IAAD,CATA,AASC,CATuC,kBAAkB,GASzD;IATY,0CAAe","file":"validation.js","sourcesContent":["import {\r\n\tIOnValidateMethod, ISyncValidation,\r\n\tIValidation, IAsyncValidation, IValidationMethod\r\n} from \"./interface/i-validation\";\r\n\r\n//usado para manter uma unica referencia de memÃ³ria\r\nconst nothing = () => {};\r\n//usado para fornecer um id incrementado do token para o validation\r\nlet token = new Date().getTime();\r\n\r\nexport abstract class AbstractValidation<T, R> implements IValidation<T, R> {\r\n\tprotected method: IValidationMethod<T, R>;\r\n\tprotected callback: IOnValidateMethod<this> = nothing;\r\n\tpublic template: string = \"\";\r\n\tprivate tokenId:number = token++;\r\n\tpublic isCanceled:boolean;\r\n\tpublic setMethod(method: IValidationMethod<T, R>): this {\r\n\t\tthis.method = method;\r\n\t\treturn this;\r\n\t}\r\n\tpublic getMethod(): IValidationMethod<T, R> {\r\n\t\treturn this.method;\r\n\t}\r\n\tpublic setMessage(template: string): this {\r\n\t\tthis.template = template;\r\n\t\treturn this;\r\n\t}\r\n\tpublic onValidate(method: IOnValidateMethod<this>): this {\r\n\t\tthis.callback = method;\r\n\t\treturn this;\r\n\t}\r\n\tpublic getMessage($value: T): string {\r\n\t\treturn this.template.replace(/\\{\\$value\\}/g, $value ? $value.toString() : null);\r\n\t}\r\n\tpublic cancel():void{\r\n\t\t//marcado para cancelamento no proximo validate\r\n\t\tthis.isCanceled = true;\r\n\t}\r\n\tpublic abstract validate(value: T): R;\r\n}\r\n\r\nexport class Validation<T> extends AbstractValidation<T, boolean> implements ISyncValidation<T> {\r\n\tpublic validate(value: T): boolean {\r\n\t\tlet isValid: boolean = this.getMethod().apply(this, [value]);\r\n\t\tlet message: string = isValid ? null : this.getMessage(value);\r\n\t\tthis.callback(message, this);\r\n\t\treturn isValid;\r\n\t}\r\n}\r\n\r\nexport class AsyncValidation<T> extends AbstractValidation<T, Promise<boolean>> implements IAsyncValidation<T> {\r\n\tpublic validate(value: T): Promise<boolean> {\r\n\t\treturn (<Promise<boolean>>this.method.apply(this, [value]))\r\n\t\t\t.then(isValid => {\r\n\t\t\t\tlet message: string = isValid ? null : this.getMessage(value);\r\n\t\t\t\tthis.callback(message, this);\r\n\t\t\t\treturn isValid;\r\n\t\t\t});\r\n\t}\r\n}\r\n"]}